---
name: version-control-guidelines
description: Git運用ガイドライン、ブランチ戦略、コミットメッセージ、プルリクエスト、個人開発とチーム開発の使い分け
---

# Version Control Guidelines

## 概要

このSkillは、Gitを使用したバージョン管理の運用ガイドラインを定義する。個人開発ではスピードを重視したシンプルな運用、チーム開発では品質とコラボレーションのバランスを重視した運用を実現することを目的とする。

## 責任範囲

このSkillは以下の範囲をカバーする:

- 個人開発とチーム開発の運用方針の使い分け
- ブランチ戦略（個人開発・チーム開発別）
- コミットメッセージの記述ルール
- プルリクエストのガイドライン
- マージ方針とコンフリクト解決
- タグとリリース管理
- .gitignoreの設定ガイドライン

## 基本方針

### 個人開発の場合（スピード重視）

- シンプルなブランチ戦略を採用する
- コミットメッセージは簡潔でOK
- PRは任意（自己レビューで十分な場合はスキップ可）
- 素早く実装して素早くリリースする
- ローカルでの実験的な作業を許容する

### チーム開発の場合（バランス重視）

- 明確なブランチ戦略を採用する
- コミットメッセージは詳細に記述する
- PRは必須でレビュープロセスを経る
- 品質とスピードのバランスを取る
- チーム全体でルールを統一する

## ブランチ戦略

### ブランチ戦略: 個人開発の場合

シンプルな2ブランチモデルを採用する。

**メインブランチ**:

- `main`: 本番環境にデプロイ可能な状態を保つ

**作業ブランチ**:

- `feat/機能名`: 新機能の開発
- `fix/修正内容`: バグ修正
- `exp/実験内容`: 実験的な実装（任意）

**運用フロー**:

1. `main`から作業ブランチを作成
2. 作業ブランチで実装
3. 動作確認後、`main`にマージ
4. 作業ブランチを削除

良い例:

```bash
# 新機能の開発
git checkout main
git pull
git checkout -b feat/user-auth
# 実装作業
git add .
git commit -m "ユーザー認証機能を実装"
git push origin feat/user-auth
# mainにマージ（PRは任意）
git checkout main
git merge feat/user-auth
git push origin main
git branch -d feat/user-auth
```

### ブランチ戦略: チーム開発の場合

Git Flow風のブランチモデルを採用する。

**永続ブランチ**:

- `main`: 本番環境にデプロイされている状態
- `develop`: 開発中の最新状態（次回リリース候補）

**一時ブランチ**:

- `feature/機能名`: 新機能の開発（developから分岐）
- `fix/修正内容`: バグ修正（developから分岐）
- `hotfix/緊急修正内容`: 本番環境の緊急修正（mainから分岐）
- `release/バージョン番号`: リリース準備（developから分岐）

**運用フロー**:

1. `develop`から作業ブランチを作成
2. 作業ブランチで実装
3. PRを作成してレビュー依頼
4. レビュー承認後、`develop`にマージ
5. リリース時に`develop`から`release`ブランチを作成
6. `release`ブランチで最終調整後、`main`と`develop`にマージ
7. `main`にタグを付ける

良い例:

```bash
# 新機能の開発
git checkout develop
git pull
git checkout -b feature/user-profile
# 実装作業
git add .
git commit -m "feat: ユーザープロフィール編集機能を実装"
git push origin feature/user-profile
# PRを作成してレビュー依頼
# レビュー承認後、GitHubでマージ
```

ホットフィックスの例:

```bash
# 本番環境の緊急修正
git checkout main
git pull
git checkout -b hotfix/login-error
# 修正作業
git add .
git commit -m "fix: ログインエラーを緊急修正"
git push origin hotfix/login-error
# PRを作成して迅速にレビュー
# マージ後、mainとdevelopの両方に反映
```

## コミットメッセージ

### コミットメッセージ: 個人開発の場合

簡潔で分かりやすいメッセージを記述する。

**基本形式**:

```text
実装内容や修正内容を簡潔に記述
```

良い例:

```text
ユーザー認証機能を実装
ログインバグを修正
パフォーマンスを改善
README更新
```

悪い例:

```text
修正
update
fix
WIP
```

### コミットメッセージ: チーム開発の場合

Conventional Commits形式を採用し、詳細な情報を記述する。

**基本形式**:

```text
<type>: <subject>

<body>

<footer>
```

**Type（必須）**:

- `feat`: 新機能
- `fix`: バグ修正
- `docs`: ドキュメント更新
- `style`: コードスタイル修正（フォーマット、セミコロンなど）
- `refactor`: リファクタリング
- `test`: テスト追加・修正
- `chore`: ビルドプロセス、ツール設定など
- `perf`: パフォーマンス改善

**Subject（必須）**:

- 50文字以内
- 命令形で記述（「〜を追加」「〜を修正」）
- 文末にピリオドを付けない

**Body（任意）**:

- 変更の理由や背景を記述
- 72文字で改行

**Footer（任意）**:

- 破壊的変更（Breaking Changes）
- Issue番号（Closes #123, Fixes #456）

良い例:

```text
feat: ユーザープロフィール編集機能を追加

ユーザーが自分のプロフィール情報（名前、メールアドレス、
プロフィール画像）を編集できる機能を実装した。

Closes #123
```

```text
fix: ログイン時のセッションタイムアウト問題を修正

セッションの有効期限が正しく設定されず、ログイン後すぐに
タイムアウトする問題を修正した。セッション管理ロジックを
見直し、有効期限を30分に設定した。

Fixes #456
```

破壊的変更の例:

```text
feat: 認証APIのエンドポイントを変更

認証APIのエンドポイントを /auth から /api/v2/auth に変更した。
これにより、既存のクライアントは更新が必要になる。

BREAKING CHANGE: 認証APIのエンドポイントが変更されました。
/auth は廃止され、/api/v2/auth を使用してください。
```

### コミットの粒度: 個人開発とチーム開発

**個人開発の場合**:

- 機能単位でコミットする
- 細かく分けすぎない（まとめてOK）
- WIPコミットも許容する

**チーム開発の場合**:

- 論理的な変更単位でコミットする
- 1つのコミットで1つの変更を表現する
- WIPコミットは避ける（最終的にsquashする）

## プルリクエスト（PR）

### プルリクエスト: 個人開発の場合

PRは任意とする。以下の場合はPRをスキップしてよい:

- 小規模な修正（タイポ修正、コメント追加など）
- 実験的な実装
- 個人プロジェクトで自己レビューが十分な場合

PRを作成する場合は、簡潔な説明で十分。

良い例:

```markdown
## 概要
ユーザー認証機能を実装しました。
```

### プルリクエスト: チーム開発の場合

PRは必須とする。

**PRのタイトル**:

- コミットメッセージと同様の形式
- 50文字以内で簡潔に

**PRの説明**:

- 変更の概要
- 変更の理由
- 動作確認の内容
- レビュー観点
- 関連Issue（Closes #123）

PRテンプレート例:

```markdown
## 概要
この変更の概要を記載してください。

## 変更内容
- 変更内容1
- 変更内容2
- 変更内容3

## 変更の理由
なぜこの変更が必要だったのかを記載してください。

## 動作確認
- [ ] ローカル環境で動作確認済み
- [ ] テストケースを追加した
- [ ] 既存のテストが通ることを確認した

## レビュー観点
レビュアーに特に確認してほしい点を記載してください。

## 関連Issue
Closes #123
```

### PRのレビュー: 個人開発とチーム開発

**個人開発の場合**:

- セルフレビューでOK
- CI/CDが通ればマージ可

**チーム開発の場合**:

- 最低1名の承認が必要
- コードレビューのポイント:
  - コーディング規約に従っているか
  - テストが適切に追加されているか
  - セキュリティ上の問題がないか
  - パフォーマンスへの影響
  - ドキュメントが更新されているか

レビューコメントの書き方:

```markdown
# 良いコメント例
[提案] この処理は共通関数として切り出せそうです。
再利用性が高まると思います。

[質問] この条件分岐の理由を教えていただけますか？

[重要] この実装はSQLインジェクションの脆弱性があります。
プリペアドステートメントを使用してください。

# 悪いコメント例
これはおかしい
なぜこう書いたの？
ダメ
```

## マージ方針

### マージ方針: 個人開発の場合

**マージ方法**:

- Merge Commit: 履歴を残したい場合
- Squash and Merge: コミット履歴をシンプルにしたい場合（推奨）
- Rebase and Merge: 線形の履歴を保ちたい場合

**コンフリクト解決**:

- ローカルで解決してpush
- シンプルな方法を選ぶ

### マージ方針: チーム開発の場合

**マージ方法**:

- `feature` → `develop`: Squash and Merge（推奨）
- `develop` → `main`: Merge Commit（履歴を保つ）
- `hotfix` → `main`: Merge Commit（緊急性を記録）

**コンフリクト解決**:

- コンフリクトが発生したら、必ず元のブランチ（develop）を最新化してから解決する
- 解決後は必ずテストを実行する
- 不明な点があればチームに相談する

良い例:

```bash
# developを最新化してコンフリクト解決
git checkout feature/user-profile
git fetch origin
git rebase origin/develop
# コンフリクト解決
git add .
git rebase --continue
# テスト実行
npm test
git push origin feature/user-profile --force-with-lease
```

## タグとリリース管理

### タグとリリース: 個人開発の場合

リリース時に任意でタグを付ける。

```bash
git tag -a v1.0.0 -m "初回リリース"
git push origin v1.0.0
```

### タグとリリース: チーム開発の場合

セマンティックバージョニング（Semantic Versioning）を採用する。

**バージョン形式**: `MAJOR.MINOR.PATCH`

- `MAJOR`: 破壊的変更
- `MINOR`: 新機能追加（後方互換性あり）
- `PATCH`: バグ修正（後方互換性あり）

良い例:

```bash
# パッチリリース（バグ修正）
git tag -a v1.0.1 -m "ログインバグを修正"

# マイナーリリース（新機能）
git tag -a v1.1.0 -m "ユーザープロフィール機能を追加"

# メジャーリリース（破壊的変更）
git tag -a v2.0.0 -m "認証APIのエンドポイントを変更（Breaking Change）"

git push origin --tags
```

## .gitignoreの設定

### .gitignoreの基本ルール

以下のファイルは必ず.gitignoreに追加する:

**環境依存ファイル**:

- `.env`
- `*.local`
- `.vscode/settings.json`（チーム共通設定以外）

**ビルド生成物**:

- `bin/`
- `obj/`
- `dist/`
- `build/`
- `node_modules/`

**OS生成ファイル**:

- `.DS_Store`
- `Thumbs.db`
- `desktop.ini`

**機密情報**:

- `*.key`
- `*.pem`
- `credentials.json`
- `secrets.yaml`

良い例（.NET プロジェクト）:

```gitignore
# ビルド生成物
bin/
obj/
*.dll
*.exe
*.pdb

# ユーザー固有ファイル
*.user
*.suo
*.userosscache
*.sln.docstates

# 環境変数
.env
.env.local
appsettings.Development.json

# OS生成ファイル
.DS_Store
Thumbs.db

# IDE
.vscode/
.idea/
*.swp
```

## ベストプラクティス

### ベストプラクティス: 個人開発の場合

- 頻繁にコミットする
- 定期的にリモートにpushする（バックアップ）
- 実験的なブランチは気軽に作成する
- 不要になったブランチはこまめに削除する

### ベストプラクティス: チーム開発の場合

- developブランチを常に最新に保つ
- PRは小さく保つ（500行以内を目安）
- レビューは24時間以内に対応する
- コンフリクトは早めに解消する
- コミット前にテストを実行する
- 機密情報をコミットしない

## チェックリスト

### ブランチ作成時

**個人開発**:

- [ ] mainから最新のコードを取得した
- [ ] 適切なブランチ名を付けた（feat/、fix/など）

**チーム開発**:

- [ ] developから最新のコードを取得した
- [ ] 適切なブランチ名を付けた（feature/、fix/など）
- [ ] ブランチの目的が明確である

### コミット時

**個人開発**:

- [ ] 簡潔で分かりやすいコミットメッセージを記述した
- [ ] 機密情報を含めていない

**チーム開発**:

- [ ] Conventional Commits形式でコミットメッセージを記述した
- [ ] 論理的な変更単位でコミットした
- [ ] テストが通ることを確認した
- [ ] 機密情報を含めていない
- [ ] コーディング規約に従っている

### PR作成時

**個人開発**:

- [ ] 必要に応じてPRを作成した
- [ ] 簡潔な説明を記載した

**チーム開発**:

- [ ] PRテンプレートに従って記載した
- [ ] 関連Issueを参照した（Closes #123）
- [ ] 動作確認を実施した
- [ ] テストを追加した
- [ ] ドキュメントを更新した（必要に応じて）
- [ ] レビュアーを指定した

### マージ時

**個人開発**:

- [ ] 動作確認が完了している
- [ ] CI/CDが通っている（設定している場合）

**チーム開発**:

- [ ] レビュー承認を得た
- [ ] CI/CDが通っている
- [ ] コンフリクトが解消されている
- [ ] developブランチが最新である
- [ ] テストが通っている

### リリース時

**個人開発**:

- [ ] 動作確認が完了している
- [ ] 必要に応じてタグを付けた

**チーム開発**:

- [ ] releaseブランチから最終確認を実施した
- [ ] セマンティックバージョニングに従ってタグを付けた
- [ ] リリースノートを作成した
- [ ] mainとdevelopの両方に反映した
